{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useReducer, useEffect, useState } from \"react\";\nimport { projectFirestore, timestamp } from '../Firebase/config';\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null\n};\n\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case 'IS_PENDING':\n      return {\n        isPending: true,\n        document: null,\n        success: false,\n        error: null\n      };\n\n    case 'ADDED_DOCUMENT':\n      return {\n        isPending: false,\n        document: action.payload,\n        success: true,\n        error: null\n      };\n\n    case 'DELETED_DOCUMENT':\n      return {\n        isPending: false,\n        document: null,\n        success: true,\n        error: null\n      };\n\n    case 'ERROR':\n      return {\n        isPending: false,\n        document: null,\n        success: false,\n        error: action.payload\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport const useFirestore = collection => {\n  _s();\n\n  const [response, dispatch] = useReducer(firestoreReducer, initialState);\n  const [isCancelled, setIsCancelled] = useState(false); // collection ref\n\n  const ref = projectFirestore.collection(collection); // only dispatch is not cancelled\n\n  const dispatchIfNotCancelled = action => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  }; // add a document\n\n\n  const addDocument = async doc => {\n    dispatch({\n      type: 'IS_PENDING'\n    });\n\n    try {\n      const createdAt = timestamp.fromDate(new Date());\n      const addedDocument = await ref.add({ ...doc,\n        createdAt\n      });\n      dispatchIfNotCancelled({\n        type: 'ADDED_DOCUMENT',\n        payload: addedDocument\n      });\n    } catch (err) {\n      dispatchIfNotCancelled({\n        type: 'ERROR',\n        payload: err.message\n      });\n    }\n  }; // delete a document\n\n\n  const deleteDocument = async id => {\n    dispatch({\n      type: 'IS_PENDING'\n    });\n\n    try {\n      await ref.doc(id).delete();\n      dispatchIfNotCancelled({\n        type: 'DELETED_DOCUMENT'\n      });\n    } catch (err) {\n      dispatchIfNotCancelled({\n        type: 'ERROR',\n        payload: 'could not delete'\n      });\n    }\n  };\n\n  useEffect(() => {\n    return () => setIsCancelled(true);\n  }, []);\n  return {\n    addDocument,\n    deleteDocument,\n    response\n  };\n};\n\n_s(useFirestore, \"9EVgiqay/R51d/Adc6OMNoHTwUQ=\");","map":{"version":3,"names":["useReducer","useEffect","useState","projectFirestore","timestamp","initialState","document","isPending","error","success","firestoreReducer","state","action","type","payload","useFirestore","collection","response","dispatch","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","createdAt","fromDate","Date","addedDocument","add","err","message","deleteDocument","id","delete"],"sources":["/Users/kery/Desktop/event_planner-development/src/hooks/useFirestore.js"],"sourcesContent":["import { useReducer, useEffect, useState } from \"react\"\nimport { projectFirestore, timestamp } from '../Firebase/config'\n\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null\n}\n\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case 'IS_PENDING':\n      return { isPending: true, document: null, success: false, error: null }\n    case 'ADDED_DOCUMENT':\n      return { isPending: false, document: action.payload, success: true, error: null }\n    case 'DELETED_DOCUMENT':\n      return { isPending: false, document: null, success: true, error: null }\n    case 'ERROR':\n      return { isPending: false, document: null, success: false, error: action.payload }\n    default:\n      return state\n  }\n}\n\nexport const useFirestore = (collection) => {\n  const [response, dispatch] = useReducer(firestoreReducer, initialState)\n  const [isCancelled, setIsCancelled] = useState(false)\n\n  // collection ref\n  const ref = projectFirestore.collection(collection)\n\n  // only dispatch is not cancelled\n  const dispatchIfNotCancelled = (action) => {\n    if (!isCancelled) {\n      dispatch(action)\n    }\n  }\n\n  // add a document\n  const addDocument = async (doc) => {\n    dispatch({ type: 'IS_PENDING' })\n\n    try {\n      const createdAt = timestamp.fromDate(new Date())\n      const addedDocument = await ref.add({ ...doc, createdAt })\n      dispatchIfNotCancelled({ type: 'ADDED_DOCUMENT', payload: addedDocument })\n    }\n    catch (err) {\n      dispatchIfNotCancelled({ type: 'ERROR', payload: err.message })\n    }\n  }\n\n  // delete a document\n  const deleteDocument = async (id) => {\n    dispatch({ type: 'IS_PENDING' })\n\n    try {\n      await ref.doc(id).delete()\n      dispatchIfNotCancelled({ type: 'DELETED_DOCUMENT' })\n    }\n    catch (err) {\n      dispatchIfNotCancelled({ type: 'ERROR', payload: 'could not delete' })\n    }\n  }\n\n  useEffect(() => {\n    return () => setIsCancelled(true)\n  }, [])\n\n  return { addDocument, deleteDocument, response }\n\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}